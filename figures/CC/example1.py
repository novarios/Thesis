import sys
import matplotlib
import matplotlib.pyplot as plt
import matplotlib.colors as colors
import matplotlib.font_manager
import numpy as np
from scipy.interpolate import interp2d
from matplotlib.patches import ConnectionPatch

z1 = np.array([3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0, 0, 0, 0, 0, 0, 0.5, 5, 0.5, 0.5, 0.5, 0, 0.5, 0, 0, 0.5, 0.5, 0.5, 0, 0, 0, 0.5, 0.5, 7, 0, 0.5, 0.5, 0.5, 0, 0, 0.5, 0, 0, 0.5, 0.5, 0, 0.5, 0.5, 0, 7, 0, 0.5, 0, 0.5, 0.5, 0.5, 0.5, 0.5, 0, 0, 0, 0.5, 0.5, 0.5, 0, 9, 0, 0.5, 0.5, 0, 0, 0.5, 0, 0.5, 0, 0.5, 0.5, 0, 0.5, 0.5, 0, 9, 0, 0.5, 0.5, 0.5, 0, 0, 0.5, 0.5, 0, 0.5, 0.5, 0.5, 0, 0.5, 0, 11, 0, 0.5, 0, 0, 0.5, 0, 0.5, 0.5, 0.5, 0, 0, 0.5, 0.5, 0.5, 0, 11, 0.5, 0, 0.5, 0, 0.5, 0, 0.5, 0.5, 0, 0, 0.5, 0, 0.5, 0.5, 0.5, 13, 0, 0, 0.5, 0, 0.5, 0.5, 0, 0.5, 0.5, 0.5, 0, 0.5, 0, 0, 0, 11, 0.5, 0.5, 0.5, 0.5, 0, 0, 0.5, 0, 0.5, 0.5, 0, 0, 0.5, 0, 0.5, 13, 0.5, 0.5, 0, 0.5, 0, 0.5, 0, 0.5, 0, 0, 0.5, 0, 0.5, 0.5, 0.5, 15, 0, 0.5, 0.5, 0, 0, 0.5, 0, 0.5, 0.5, 0, 0.5, 0, 0.5, 0.5, 0, 15, 0.5, 0.5, 0, 0, 0.5, 0, 0, 0.5, 0.5, 0, 0.5, 0.5, 0, 0.5, 0.5, 17, 0.5, 0, 0, 0, 0, 0.5, 0, 0.5, 0.5, 0.5, 0, 0.5, 0.5, 0.5, 0.5, 19])

z2 = np.array([2.6921, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0, 0, 0, 0, 0, 0, -0.18194, 5.0683, 0.33333, 0.40159, 0.33333, 0, 0.33333, 0, 0, 0.5, 0.5, 0.5, 0, 0, 0, -0.037341, 0.43333, 6.9683, 0, 0.43333, 0.40159, 0.43333, 0, 0, 0.5, 0, 0, 0.5, 0.5, 0, -0.019511, 0.29048, 0, 6.9571, 0, 0.33333, 0, 0.33333, 0.33333, 0.5, 0.5, 0.5, 0, 0, 0, -0.0071599, 0.45714, 0.45714, 0, 8.9444, 0, 0.45714, 0.40159, 0, 0, 0.5, 0, 0.5, 0, 0.5, 0.084034, 0, 0.29048, 0.43333, 0, 8.8571, 0, 0.43333, 0.43333, 0.5, 0, 0, 0.5, 0.5, 0, 0.0060752, 0.46825, 0.46825, 0, 0.46825, 0, 10.933, 0, 0.40159, 0, 0, 0.5, 0, 0.5, 0.5, 0.10835, 0, 0, 0.45714, 0.29048, 0.45714, 0, 10.833, 0.45714, 0, 0.5, 0, 0.5, 0, 0.5, 0.11963, 0, 0, 0.46825, 0, 0.46825, 0.29048, 0.46825, 12.822, 0, 0, 0.5, 0, 0.5, 0.5, 0, 0.084034, -0.019511, -0.037341, 0, -0.18194, 0, 0, 0, 11.233, 0.43333, 0.43333, 0.33333, 0.33333, 0, 0, 0.10835, 0, -0.0071599, -0.019511, 0, 0, -0.18194, 0, 0.45714, 13.21, 0.45714, 0.33333, 0, 0.33333, 0, 0.11963, 0, 0.0060752, 0, 0, -0.019511, 0, -0.18194, 0.46825, 0.46825, 15.198, 0, 0.33333, 0.33333, 0, 0, 0.10835, 0, 0.084034, -0.0071599, 0, -0.037341, 0, 0.45714, 0.43333, 0, 15.11, 0.45714, 0.43333, 0, 0, 0.11963, 0, 0, 0.0060752, 0.084034, 0, -0.037341, 0.46825, 0, 0.43333, 0.46825, 17.098, 0.43333, 0, 0, 0, 0, 0.11963, 0, 0.10835, 0.0060752, -0.0071599, 0, 0.46825, 0.45714, 0.46825, 0.45714, 19.075])

z3 = np.array([2.7106, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0, 0, 0, 0, 0, 0, 7.193e-06, 5.0113, 0.37286, 0.38418, 0.37286, 0, 0.37286, 0, 0, 0.5, 0.5, 0.5, 0, 0, 0, -2.9705e-06, 0.42806, 6.9561, 0, 0.42806, 0.38418, 0.42806, 0, 0, 0.5, 0, 0, 0.5, 0.5, 0, -3.7495e-06, 0.32644, 0, 6.9536, 0, 0.37286, 0, 0.37286, 0.37286, 0.5, 0.5, 0.5, 0, 0, 0, -7.5054e-06, 0.44914, 0.44914, 0, 8.935, 0, 0.44914, 0.38418, 0, 0, 0.5, 0, 0.5, 0, 0.5, -2.1037e-06, 0, 0.32644, 0.42806, 0, 8.8984, 0, 0.42806, 0.42806, 0.5, 0, 0, 0.5, 0.5, 0, -1.0243e-05, 0.46056, 0.46056, 0, 0.46056, 0, 10.924, 0, 0.38418, 0, 0, 0.5, 0, 0.5, 0.5, -3.8146e-06, 0, 0, 0.44914, 0.32644, 0.44914, 0, 10.877, 0.44914, 0, 0.5, 0, 0.5, 0, 0.5, -5.826e-06, 0, 0, 0.46056, 0, 0.46056, 0.32644, 0.46056, 12.866, 0, 0, 0.5, 0, 0.5, 0.5, 0, -2.1037e-06, -3.7495e-06, -2.9705e-06, 0, 7.193e-06, 0, 0, 0, 11.199, 0.42806, 0.42806, 0.37286, 0.37286, 0, 0, -3.8146e-06, 0, -7.5054e-06, -3.7495e-06, 0, 0, 7.193e-06, 0, 0.44914, 13.178, 0.44914, 0.37286, 0, 0.37286, 0, -5.826e-06, 0, -1.0243e-05, 0, 0, -3.7495e-06, 0, 7.193e-06, 0.46056, 0.46056, 15.167, 0, 0.37286, 0.37286, 0, 0, -3.8146e-06, 0, -2.1037e-06, -7.5054e-06, 0, -2.9705e-06, 0, 0.44914, 0.42806, 0, 15.123, 0.44914, 0.42806, 0, 0, -5.826e-06, 0, 0, -1.0243e-05, -2.1037e-06, 0, -2.9705e-06, 0.46056, 0, 0.42806, 0.46056, 17.111, 0.42806, 0, 0, 0, 0, -5.826e-06, 0, -3.8146e-06, -1.0243e-05, -7.5054e-06, 0, 0.46056, 0.44914, 0.46056, 0.44914, 19.09])

matrix1 = np.zeros((15, 15))
matrix2 = np.zeros((15, 15))
matrix3 = np.zeros((15, 15))

for i in range(15):
    for j in range(15):
        matrix1[i,j] = np.log(np.absolute(z1[(14-i)*15 + j]) + 1.0e-8)
        matrix2[i,j] = np.log(np.absolute(z2[(14-i)*15 + j]) + 1.0e-8)
        matrix3[i,j] = np.log(np.absolute(z3[(14-i)*15 + j]) + 1.0e-8)

xi = np.arange(0, 16)
yi = np.arange(0, 16)
X, Y = np.meshgrid(xi, yi)
Vmin = 0.75*np.array([matrix1.min(),matrix2.min(),matrix3.min()]).min()
Vmax = 1.5*np.array([matrix1.max(),matrix2.max(),matrix3.max()]).max()
print Vmin, Vmax
#v = np.linspace(Vmin, Vmax, 10, endpoint=True)
v = np.linspace(-12, 3, 6, endpoint=True)

#fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 6))

plt.rc('axes', labelsize='large')
plt.rc('font', weight='semibold')
plt.rc('lines', lw=5)

plt.pcolormesh(X, Y, matrix1, vmin=Vmin, vmax=Vmax, cmap='viridis_r')
plt.colorbar(ticks=v, pad=0.01)
plt.axis([0, 15, 0, 15])
plt.axis('off')
plt.savefig('pairingexample1.pdf', format='pdf', bbox_inches='tight')
plt.show()

plt.pcolormesh(X, Y, matrix3, vmin=Vmin, vmax=Vmax, cmap='viridis_r')
plt.colorbar(ticks=v, pad=0.01)
plt.axis([0, 15, 0, 15])
plt.axis('off')
plt.savefig('pairingexample2.pdf', format='pdf', bbox_inches='tight')
plt.show()

